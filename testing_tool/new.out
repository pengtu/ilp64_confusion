cc ddot_ilp64.c -g -shared -DMKL_ILP64=1 -I/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/include -O0 -std=c99 -fPIC -ldl -Wl,-rpath,/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/lib/intel64 -L/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/lib/intel64 -Wl,--no-as-needed -lmkl_sequential -lmkl_core -lmkl_intel_ilp64_ -o libddot-ilp64.so
cc ddot.c -g -shared -I/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/include -O0 -std=c99 -fPIC -ldl -Wl,-rpath,/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/lib/intel64 -L/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/lib/intel64 -Wl,--no-as-needed -lmkl_sequential -lmkl_core -lmkl_intel_lp64 -o libddot-lp64.so
cc foo.c -g -I/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/include -O0 -std=c99 -fPIC -ldl -Wl,-rpath,/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/lib/intel64 -L/export/users/ptu1/workspace/mkl/src/__release_lnx/mkl/lib/intel64 -Wl,--no-as-needed -o foo
\033[0;31mRunning code expecting LP64 on LP64 mkl\033[0m (should work)
./foo LOAD_MKL_LP64 CALL_LP64
Loading libmkl_core.so...
Loading libmkl_sequential.so...
Loading libmkl_intel_lp64.so...
Loading ./libddot-lp64.so...
 - ddot(): sizeof(MKL_INT) == 4
 - result: 285

\033[0;31mRunning code expecting ILP64 on ILP64 mkl\033[0m (should work)
./foo LOAD_MKL_ILP64 CALL_ILP64
Loading libmkl_core.so...
Loading libmkl_sequential.so...
Loading libmkl_intel_ilp64_.so...
Loading ./libddot-ilp64.so...
 - ddot(): sizeof(MKL_INT) == 8
 - result: 285

\033[0;31mRunning code expecting LP64 on ILP64 mkl\033[0m (BROKEN)
./foo LOAD_MKL_ILP64 CALL_LP64
Loading libmkl_core.so...
Loading libmkl_sequential.so...
Loading libmkl_intel_ilp64_.so...
Loading ./libddot-lp64.so...
 - ddot(): sizeof(MKL_INT) == 4
 - result: 285

\033[0;31mRunning code expecting ILP64 on LP64 mkl\033[0m (BROKEN)
./foo LOAD_MKL_LP64 CALL_ILP64
Loading libmkl_core.so...
Loading libmkl_sequential.so...
Loading libmkl_intel_lp64.so...
Loading ./libddot-ilp64.so...
 - ddot(): sizeof(MKL_INT) == 8
 - result: 285

\033[0;31mRunning LP64 code after running ILP64 code\033[0m (BROKEN)
./foo LOAD_MKL_ILP64 CALL_ILP64 CALL_LP64
Loading libmkl_core.so...
Loading libmkl_sequential.so...
Loading libmkl_intel_ilp64_.so...
Loading ./libddot-ilp64.so...
 - ddot(): sizeof(MKL_INT) == 8
 - result: 285
Loading ./libddot-lp64.so...
 - ddot(): sizeof(MKL_INT) == 4
 - result: 285

\033[0;31mRunning LP64 code after running ILP64 code (with no explicit loading)\033[0m (INCOMPATIBLE WITH JULIA)
./foo CALL_ILP64 CALL_LP64
Loading ./libddot-ilp64.so...
 - ddot(): sizeof(MKL_INT) == 8
 - result: 285
Loading ./libddot-lp64.so...
 - ddot(): sizeof(MKL_INT) == 4
 - result: 285

